---
import { cn } from '@/utils'

const { as: Tag = 'a', class: className, title, href, style = 'button' } = Astro.props

const basePath = import.meta.env.BASE_URL.replace(/\/$/, '')
const isExternal = (value?: string) => value?.startsWith('http') || value?.startsWith('mailto:') || value?.startsWith('#')
const resolvedHref = !href
	? undefined
	: isExternal(href)
	?	 href
	: href.startsWith('/')
	? `${basePath}${href}`
	: href
---

<Tag
	class={cn(
		className,
		'inline-flex items-center gap-x-1 rounded-lg bg-primary-foreground border border-border px-2 py-1 text-sm transition-all hover:bg-input',
		!href && 'cursor-default',
		style === 'pill' && 'rounded-xl'
	)}
	href={Tag === 'a' ? resolvedHref : undefined}
	data-astro-prefetch={Tag === 'a' ? true : undefined}
>
	<slot name='icon-before' />
	<p>{title}</p>
	<slot name='icon-after' />
</Tag>
