---
import PageLayout from '@/layouts/BaseLayout.astro'
import Section from '@/components/Section.astro'
import ProjectCard from '@/components/ProjectCard.astro'
import Label from '@/components/Label.astro'

import { Icon } from 'astro-icon/components'
import { Image } from 'astro:assets'

import astro from '@/assets/4423icon_768x768_circle.png'
import unityIcon from '../icons/unity.svg'
import vscodeIcon from '../icons/vscode.svg'
import asepriteIcon from '../icons/aseprite.svg'
import clipStudioIcon from '../icons/clipstudiopaint.png'
import xIcon from '../icons/x.svg'
import discordIcon from '../icons/discord.svg'

import type { LocaleContent } from '@/data/portfolioContent'

interface Props {
  content: LocaleContent
}

const { content } = Astro.props as Props

const meta = {
  title: content.metaTitle,
  description: content.metaDescription,
}

const toolIcons = {
  unity: unityIcon,
  vscode: vscodeIcon,
  clipStudio: clipStudioIcon,
  aseprite: asepriteIcon,
} as const

const contactIcons = {
  x: xIcon,
  discord: discordIcon,
} as const

const tools = content.tools.map((tool) => ({
  ...tool,
  icon: toolIcons[tool.iconKey],
}))

const DEFAULT_PROJECT_IMAGE = '/src/assets/coming-soon.png'
---

<PageLayout meta={meta} lang={content.htmlLang}>
  <div class='flex w-full flex-col gap-y-12'>
    <section class='flex flex-col items-center gap-y-7 text-center'>
      <Image
        src={astro}
        alt='profile photo placeholder'
        class='profile-icon h-28 w-28 object-cover'
        loading='eager'
      />
      <div class='flex max-w-2xl flex-col items-center gap-y-4'>
        <h1 class='text-3xl font-bold'>{content.profile.name}</h1>
        <p class='text-lg text-muted-foreground'>{content.profile.tagline}</p>
        <div class='flex gap-x-3'>
          {content.contactLinks.map((contact) => (
            <a
              class='flex h-10 w-10 items-center justify-center rounded-full border border-border bg-primary-foreground text-muted-foreground transition-all hover:text-foreground'
              href={contact.href}
              aria-label={contact.title}
              target='_blank'
              rel='noopener noreferrer'
            >
              <Image src={contactIcons[contact.icon]} alt={contact.title} class='h-5 w-5 object-contain' />
            </a>
          ))}
        </div>
        <p class='text-muted-foreground'>{content.profile.summary}</p>
      </div>
    </section>

    <Section title={content.sectionTitles.projects}>
      <div class='flex flex-col gap-y-3 sm:flex-row sm:gap-x-3 sm:gap-y-0'>
        {content.projects.map((project) => (
          <ProjectCard
            class='w-full sm:w-1/2'
            href={project.href}
            heading={project.title}
            subheading={project.role}
            imagePath={DEFAULT_PROJECT_IMAGE}
            altText={`${project.title} cover image placeholder`}
          >
            <p class='px-5 pb-5 text-sm text-muted-foreground'>{project.description}</p>
          </ProjectCard>
        ))}
      </div>
    </Section>

    <Section title={content.sectionTitles.about}>
      <div class='flex flex-col gap-y-8'>
        <div class='space-y-4 text-muted-foreground'>
          {content.aboutParagraphs.map((text) => (
            <p class='leading-relaxed'>{text}</p>
          ))}
        </div>

        <article class='rounded-2xl border border-border bg-primary-foreground p-5'>
          <h3 class='text-lg font-medium'>{content.sectionTitles.specialties}</h3>
          <ul class='mt-3 space-y-2 text-muted-foreground'>
            {content.specialties.map((item) => (
              <li>{item}</li>
            ))}
          </ul>
        </article>

        <article class='rounded-2xl border border-border bg-primary-foreground p-5'>
          <h3 class='text-lg font-medium'>{content.sectionTitles.tools}</h3>
          <ul class='mt-3 space-y-3'>
            {tools.map((tool) => (
              <li class='flex items-center gap-x-3 rounded-xl border border-border px-3 py-2'>
                <Image src={tool.icon} alt={`${tool.name} logo`} class='h-6 w-6 object-contain' />
                <div class='flex flex-col'>
                  <p class='font-medium'>{tool.name}</p>
                  {tool.note && (
                    <p class='text-sm text-muted-foreground'>{tool.note}</p>
                  )}
                </div>
              </li>
            ))}
          </ul>
        </article>

        <article class='rounded-2xl border border-border bg-primary-foreground p-5'>
          <h3 class='text-lg font-medium'>{content.sectionTitles.contributions}</h3>
          <ul class='mt-3 space-y-3'>
            {content.contributions.map((item) => (
              <li class='rounded-xl border border-border px-3 py-2'>
                <p class='font-medium'>{item.title}</p>
                <p class='text-sm text-muted-foreground'>{item.detail}</p>
              </li>
            ))}
          </ul>
        </article>

        <article class='rounded-2xl border border-border bg-primary-foreground p-5'>
          <h3 class='text-lg font-medium'>{content.sectionTitles.programmingLanguages}</h3>
          <p class='mt-3 text-sm text-muted-foreground'>
            {content.programmingLanguagesNote}
          </p>
          <div class='mt-4 flex flex-wrap gap-3'>
            {content.languages.map((language) => (
              <Label
                title={language}
                class='rounded-xl border border-border bg-background/60 px-3 py-2'
              >
                <Icon slot='icon' name='code' class='h-5 w-5 text-muted-foreground' />
              </Label>
            ))}
          </div>
        </article>
      </div>
    </Section>
  </div>
</PageLayout>

<style>
  .profile-icon {
    border-radius: 9999px;
    background-color: transparent;
    mask-image: radial-gradient(circle, #000 97%, transparent 100%);
    -webkit-mask-image: radial-gradient(circle, #000 97%, transparent 100%);
  }
</style>
